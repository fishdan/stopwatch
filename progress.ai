2025-12-23 Update – GitHub App bootstrap:
- Generated JWT and installation token for GitHub App ai-codex-dan; validated /app identity and /installation/repositories access.
- Confirmed installation permissions (write across contents, checks, workflows, secrets; no admin scopes) and repository visibility list from GitHub.
- Created /tmp/git-askpass.sh with the current installation token (expires 2025-12-24T00:09:39Z) and configured git user to ai-codex-dan[bot] with noreply email.
- Initialized git repository in /projects/fishdan/stopwatch; attempted to create GitHub repo fishdan/stopwatch via installation token but received 403 Resource not accessible by integration—awaiting guidance/permissions.
2025-12-23 Update – Repository creation and push:
- Remote set to https://github.com/fishdan/stopwatch.git after repo was provisioned; added .gitignore to keep secrets out of source control.
- Committed repo.ai, start.ai, progress.ai, and .gitignore with bot identity; pushed master with GIT_ASKPASS using installation token.
2025-12-23 Update – Speclit for stopwatch app:
- Drafted speclit/stopwatch.ai outlining goals, functional requirements, UI, platform considerations, open questions, and backlog tasks (SK-1..SK-7) for the RN overlay stopwatch.
- Captured iOS overlay constraints and need for platform decision before implementation.
2025-12-23 Update – Clarified requirements:
- User decisions: prioritize Android overlay; iOS can be in-app floating overlay; no lock-screen visibility; closing resets timer; drag-to-reposition desired.
- Updated speclit/stopwatch.ai to reflect resolved questions and backlog alignment.
2025-12-23 Update – RN scaffold and stopwatch UI:
- Created React Native project StopwatchApp (v0.73.6, TypeScript) with initial overlay stopwatch UI and controls (start/stop toggle, clear, close) and drag-to-reposition inside app; format mm:ss:ff using monotonic timestamps.
- Added Android manifest permissions for SYSTEM_ALERT_WINDOW and FOREGROUND_SERVICE to prep overlay service work.
- Close action resets timer and hides overlay; reopen affordance provided inside app.
2025-12-23 Update – Overlay permission scaffolding:
- Fixed overlay drag bounds and sizing constants; added Android overlay permission banner/button in UI.
- Implemented native module (OverlayPermissionModule/Package) to check/request SYSTEM_ALERT_WINDOW via settings; registered package in MainApplication.
2025-12-25 Update – Authentication and Planning:
- Bootstrapped GitHub App authentication successfully; validated credentials and configured git user as ai-codex-dan[bot].
- Verified codebase state: Timer logic and permissions scaffolding are present.
- Next Work: Transitioning StopwatchOverlay from an in-app view to a true Android system overlay via Foreground Service (SK-4).
2025-12-25 Update – Android System Overlay (SK-4):
- Implement StopwatchService.kt: Native Android Foreground Service to host the overlay view independent of RN activity.
- Implement StopwatchModule.kt: JSI Bridge to start/stop the service from React Native.
- Updated AndroidManifest: Registered service with foregroundServiceType="specialUse".
- Updated App.tsx: Added "Open System Overlay" button to trigger the native service.
- Verification Needed: Run on Android Device, grant "Display over other apps", and test persistence when app is backgrounded.
2025-12-25 Update – Android Overlay Verified:
- Successfully verified Android System Overlay on physical device (Android 16).
- Fixed crash issues by adding 'specialUse' foreground service type and matching permission in AndroidManifest.
- Added permission check in App.tsx to prompt user if 'Display over other apps' is missing.
- Verified timer counts and drag persistence works in background.
- SK-4 is COMPLETE.
2025-12-25 Update – Android Release Build Ready (SK-8):
- Generated release keystore (android/app/release.keystore).
- Configured secure signing in build.gradle using android/key.properties.
- Enabled ProGuard/Minification for release builds.
- Successfully built signed Android App Bundle (.aab).
- SK-8 is COMPLETE.
2025-12-25 Update – UI Polish & Shareable APK:
- Implemented "Dark Glass" UI theme for both Native Overlay and React Native App (SK-6).
- Created custom vector assets for Play, Pause, Stop, Close.
- Generated standalone signed APK for sharing: android/app/build/outputs/apk/release/app-release.apk.
2025-12-25 Update – Auto-Launch Implementation:
- Modified App.tsx to automatically launch the system overlay if permissions are already granted.
- Updated the release APK (v1.0.0) on GitHub with the latest build.
2025-12-25 Update – Versioning Policy & v1.0.1 Release:
- Adopted semantic versioning and incremented to v1.0.1.
- Aligned version strings in package.json (1.0.1) and Android build.gradle (versionCode 2, versionName "1.0.1").
- Fixed package name to lowercase (stopwatch-app) per npm/lint standards.
- Published official v1.0.1 release on GitHub with updated auto-launch feature.
2026-01-04 Update – App Renaming (SK-7/Refactor):
- Completed renaming of the application to "CF Stopwatch" across all platforms.
- Updated Android resource strings, package name, and system overlay UI (completed in previous session).
- Updated iOS Info.plist (CFBundleDisplayName), LaunchScreen.storyboard (UI label), and project.pbxproj (PRODUCT_NAME).
- Aligned app.json and package.json with the new branding.

2026-01-04 Update – Deploy Android Project (SK-DA):
- Created DEPLOYMENT.md, DEPLOYMENT-CHECKLIST.md, and TESTING-PLAN.md for standardized releases.
- Implemented StopwatchApp/scripts/build-release.sh to automate signed AAB generation.
- Staged cf-stopwatch-v1.1.0.aab in releases/ folder.
- Configured GitHub Actions CI/CD (.github/workflows/android-build.yml) for automated builds on version tags.

2026-01-04 Update – Submodule Migration:
- Replaced standalone `repo.ai` with `.repo_ai` git submodule for shared infrastructure.
- Updated `start.ai` entrypoint to reference the new submodule location.

2026-01-04 Update – Play Store Conflict Resolution & Release:
- Key Decision: Renamed package from `com.stopwatchapp` to `com.fishdan.cfstopwatch` to resolve Google Play Store naming conflicts.
- Refactored native Kotlin source directory structure and updated all package/import statements.
- Bumped version to `1.1.1` (versionCode 4).
- Created official GitHub Release `v1.1.1` and uploaded the signed AAB artifact.

2026-01-04 Update – Android 15 & Crash Fix (v1.1.4):
- **Issue**: App was crashing immediately on launch with "keeps stopping."
- **Root Cause**: Flipper (debug tool) was being initialized in release builds where its libraries are stripped, causing a ClassNotFoundException.
- **Fix**: Wrapped Flipper initialization in `BuildConfig.DEBUG` in `MainApplication.kt`.
- **Infrastructure**: Updated to target API 35 (Android 15) to satisfy new Play Store requirements.
- **Optimization**: Added ProGuard rules to protect native modules from being stripped during minification.
- **Release**: Successfully deployed v1.1.4 (versionCode 7) to Internal Testing.
